//create Graph Projection
CALL gds.graph.project('florentine-families', 'Family', 'MARRIED_TO')
YIELD
  graphName, nodeCount, relationshipCount
RETURN
  graphName, nodeCount, relationshipCount;

//

//calculate pageRank Centrality
//
CALL gds.pageRank.write('florentine-families', {
  maxIterations: 20,
  dampingFactor: 0.85,
  writeProperty: 'pagerank_centrality'
})
YIELD nodePropertiesWritten, ranIterations, centralityDistribution
RETURN centralityDistribution.min AS minimumScore, 
       centralityDistribution.mean AS meanScore, 
       centralityDistribution.max AS maximumScore,
       nodePropertiesWritten,
       ranIterations
//

CALL gds.graph.drop('florentine-families')
YIELD graphName;
